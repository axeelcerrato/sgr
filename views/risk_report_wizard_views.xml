<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Vista Form del Wizard de Reporte Din√°mico -->
        <record id="view_risk_report_wizard_form" model="ir.ui.view">
            <field name="name">risk.report.wizard.form</field>
            <field name="model">risk.report.wizard</field>
            <field name="arch" type="xml">
                <form string="Generador de Reportes de Riesgos">
                    
                    <!-- Encabezado con informaci√≥n -->
                    <div class="alert alert-info" role="alert">
                        <h4><i class="fa fa-info-circle"/> Generador de Reportes Din√°micos</h4>
                        <p>Configure los filtros y opciones para generar un reporte personalizado de gesti√≥n de riesgos.</p>
                        <p><strong>Riesgos estimados con filtros actuales: <field name="estimated_risks" readonly="1"/> registros</strong></p>
                    </div>

                    <sheet>
                        <!-- T√≠tulo del reporte -->
                        <group>
                            <field name="report_title" style="font-size: 16px; font-weight: bold;"/>
                        </group>

                        <!-- Notebook con diferentes secciones -->
                        <notebook>
                            
                            <!-- ===== PESTA√ëA: FILTROS PRINCIPALES ===== -->
                            <page string="üîç Filtros Principales" name="main_filters">
                                
                                <!-- Filtros de fechas -->
                                <group string="üìÖ Per√≠odo de An√°lisis">
                                    <group>
                                        <field name="date_from"/>
                                        <field name="date_to"/>
                                    </group>
                                </group>
                                
                                <!-- Filtros de tipos de riesgo -->
                                <group string="üè∑Ô∏è Tipos de Gesti√≥n de Riesgo">
                                    <group>
                                        <field name="include_isms"/>
                                        <field name="include_comp"/>
                                    </group>
                                    <group>
                                        <field name="include_orm"/>
                                    </group>
                                </group>
                                
                                <!-- Filtros de niveles de riesgo -->
                                <!-- Filtros de niveles de riesgo -->
                                <group string="‚ö†Ô∏è Niveles de Riesgo a Incluir">
                                    <group>
                                        <field name="include_critical"/>
                                        <field name="include_high"/>
                                    </group>
                                    <group>
                                        <field name="include_medium"/>
                                        <field name="include_low"/>
                                    </group>
                                </group>
                                
                            </page>
                            
                            <!-- ===== PESTA√ëA: FILTROS ESPEC√çFICOS ===== -->
                            <page string="üéØ Filtros Espec√≠ficos" name="specific_filters">
                                
                                <group>
                                    <group string="üìÇ Filtrar por Categor√≠as">
                                        <field name="category_ids" widget="many2many_tags" 
                                               placeholder="Seleccionar categor√≠as espec√≠ficas (vac√≠o = todas)"/>
                                    </group>
                                    
                                    <group string="üè¢ Filtrar por Departamentos">
                                        <field name="department_ids" widget="many2many_tags"
                                               placeholder="Seleccionar departamentos espec√≠ficos (vac√≠o = todos)"/>
                                    </group>
                                </group>
                                
                                <group>
                                    <group string="üë• Filtrar por Responsables">
                                        <field name="responsible_ids" widget="many2many_tags"
                                               placeholder="Seleccionar responsables espec√≠ficos (vac√≠o = todos)"/>
                                    </group>
                                </group>
                                
                            </page>
                            
                            <!-- ===== PESTA√ëA: CONTENIDO DEL REPORTE ===== -->
                            <page string="üìã Contenido del Reporte" name="content_options">
                                
                                <group string="üìä Secciones a Incluir">
                                    <group>
                                        <field name="include_summary"/>
                                        <field name="include_matrix"/>
                                        <field name="include_risk_details"/>
                                    </group>
                                    <group>
                                        <field name="include_charts"/>
                                        <field name="include_action_plans"/>
                                        <field name="include_methodology"/>
                                    </group>
                                </group>
                                
                                <group string="üîÑ Organizaci√≥n de los Datos">
                                    <group>
                                        <field name="group_by_type"/>
                                        <field name="group_by_category"/>
                                    </group>
                                    <group>
                                        <field name="sort_by_risk_level"/>
                                    </group>
                                </group>
                                
                            </page>
                            
                            <!-- ===== PESTA√ëA: VISTA PREVIA ===== -->
                            <page string="üëÅÔ∏è Vista Previa" name="preview">
                                
                                <div class="alert alert-warning" role="alert" invisible="estimated_risks > 0">
                                    <h4><i class="fa fa-exclamation-triangle"/> Sin Datos</h4>
                                    <p>No hay riesgos que coincidan con los filtros seleccionados. Ajuste los criterios para generar el reporte.</p>
                                </div>
                                
                                <div invisible="estimated_risks == 0">
                                    <group string="üìà Resumen de Datos">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="alert alert-success text-center" style="margin: 10px;">
                                                    <h3><field name="estimated_risks" readonly="1"/></h3>
                                                    <p><strong>Riesgos Total</strong></p>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="alert alert-info text-center" style="margin: 10px;">
                                                    <h3>N/A</h3>
                                                    <p><strong>D√≠as del Per√≠odo</strong></p>
                                                </div>
                                            </div>
                                        </div>
                                    </group>
                                    
                                    <group>
                                        <div class="text-center">
                                            <button name="action_preview_data" type="object" 
                                                    string="üìä Previsualizar Datos" 
                                                    class="btn-info"
                                                    help="Ver los riesgos que se incluir√°n en el reporte"/>
                                        </div>
                                    </group>
                                </div>
                                
                            </page>
                            
                        </notebook>
                    </sheet>
                    
                    <!-- Pie del formulario con botones de acci√≥n -->
                    <footer>
                        <div class="row">
                            <div class="col-md-6">
                                <button name="action_reset_filters" type="object" 
                                        string="üîÑ Restablecer Filtros" 
                                        class="btn-secondary"/>
                            </div>
                            <div class="col-md-6 text-right">
                                <button name="action_generate_report" type="object" 
                                        string="üìÑ Generar Reporte PDF" 
                                        class="btn-primary"
                                        invisible="estimated_risks == 0"/>
                                <button string="Cancelar" special="cancel" class="btn-default"/>
                            </div>
                        </div>
                    </footer>
                    
                </form>
            </field>
        </record>
        
        <!-- Acci√≥n para abrir el wizard -->
        <record id="action_risk_report_wizard" model="ir.actions.act_window">
            <field name="name">Generador de Reportes Din√°micos</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">risk.report.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="context">{}</field>
        </record>

    </data>
</odoo>